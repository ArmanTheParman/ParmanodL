ENVIRONMENT

    Linux Mint - linuxmint-21.2-cinnamon-64bit.iso; download to ~/Downloads/

    install squashfs-tools, genisoimage, xorriso, syslinux (These are usually installed anyway)

MAKE A TEMPORARY ISO

	mkdir -p ~/custom-mint/original-iso ; sudo mount -o loop ~/Downloads/linuxmint-21.2-cinnamon-64bit.iso ~/custom-mint/original-iso

	mkdir ~/custom-mint/iso ; cp -a ~/custom-mint/original-iso/* ~/custom-mint/iso/

	sudo unsquashfs ~/custom-mint/iso/casper/filesystem.squashfs


	sudo mount --bind /dev squashfs-root/dev ; sudo mount --bind /dev/pts squashfs-root/dev/pts

	sudo mount --bind /proc squashfs-root/proc ; sudo mount --bind /sys squashfs-root/sys

	sudo chroot squashfs-root

WITHIN THE FILE SYSTEM:

	mkdir /etc/skel/Desktop ; touch /etc/skel/Desktop/"START HERE"

START HERE - PRECISE FILE CONTENTS; RUN THIS ECHO COMMAND IN ONE GO...

echo '#!/bin/bash
if ! ping -c 1 8.8.8.8 > /dev/null ; then 
clear 
echo "Please check your internet connection before trying again. Exiting."
exit
fi
sudo apt update -y ; sudo apt install git -y
git clone http://github.com/armantheparman/parmanode.git
echo'\''#!/bin/bash
cd ; cd Desktop ; cd parmanode ; ./run_parmanode.sh
'\'' > $HOME/Desktop/run_parmanode.sh
sudo chmod +x $HOME/Desktop/run_parmanode.sh
rm $HOME/Desktop/"START HERE"
exit' > /etc/skel/Desktop/"START HERE"

MAKE SCRIPT EXECTUABLE
chmod +x /etc/skel/Desktop/"START HERE"

FINAL COMMANDS WITHIN CHROOT
> ~/.bash_history ; history -c ; exit

UNMOUNT DIRECTORIES
sudo umount squashfs-root/dev/pts squashfs-root/dev squashfs-root/proc squashfs-root/sys

SET TIMESTAMPS
sudo find squashfs-root/ -exec touch -h -d "2023-08-01 00:00:00" {} +

CLEAR SPACE
sudo rm ~/custom-mint/iso/casper/filesystem.squashfs

CREATE NEW FS
sudo mksquashfs squashfs-root ~/custom-mint/iso/casper/filesystem.squashfs

GET MBR OF ORIGINAL
sudo dd if=~/Downloads/linuxmint-21.2-cinnamon-64bit.iso bs=512 count=1 of=~/custom-mint/iso/isolinux/isohdpfx.bin


MAKE ISO
sudo xorriso -as mkisofs \
  -iso-level 3 \
  -full-iso9660-filenames \
  -volid "ParmanodL" \
  -eltorito-boot isolinux/isolinux.bin \
  -eltorito-catalog isolinux/boot.cat \
  -no-emul-boot -boot-load-size 4 -boot-info-table \
  -isohybrid-mbr ~/custom-mint/iso/isolinux/isohdpfx.bin \
  -output ParmanodL.iso \
  iso/

